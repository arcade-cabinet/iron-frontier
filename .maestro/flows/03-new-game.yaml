# Iron Frontier E2E Test: Starting New Game
# Tests the new game flow from main menu to gameplay
#
# Platforms: Android (Pixel 8a, Pixel Tablet)
# Priority: P0 (Critical)

appId: ${ANDROID_APP_ID}
name: New Game Flow
tags:
  - critical
  - gameplay
  - p0

---
# Start from main menu
- assertVisible:
    text: "New Game"
    timeout: ${DEFAULT_TIMEOUT}

# Tap New Game button
- tapOn:
    text: "New Game"
    retryTapIfNoChange: true

# Wait for transition animation
- waitForAnimationToEnd:
    timeout: ${ANIMATION_TIMEOUT}

# Verify character creation / name entry screen appears
- assertVisible:
    text: ".*"
    timeout: ${LONG_TIMEOUT}

- takeScreenshot: screenshots/03-new-game-screen

# Look for name input field
- assertVisible:
    text: "Enter your name"
    optional: true
    timeout: ${DEFAULT_TIMEOUT}

- assertVisible:
    text: "Name"
    optional: true
    timeout: ${DEFAULT_TIMEOUT}

- assertVisible:
    text: "Character"
    optional: true
    timeout: ${DEFAULT_TIMEOUT}

# Enter character name
- tapOn:
    id: "name_input"
    optional: true

- tapOn:
    id: "name-input"
    optional: true

- tapOn:
    text: "Enter your name"
    optional: true

# Input the player name
- inputText: ${PLAYER_NAME}

# Hide keyboard on Android
- hideKeyboard

- takeScreenshot: screenshots/03-name-entered

# Look for and tap the start/confirm button
- tapOn:
    text: "Start"
    optional: true

- tapOn:
    text: "Begin"
    optional: true

- tapOn:
    text: "Confirm"
    optional: true

- tapOn:
    text: "Create"
    optional: true

- tapOn:
    text: "Begin Adventure"
    optional: true

# Wait for game to load
- waitForAnimationToEnd:
    timeout: ${LONG_TIMEOUT}

# Verify game has started (look for game UI elements)
- assertVisible:
    text: ".*"
    timeout: ${LONG_TIMEOUT}

- takeScreenshot: screenshots/03-game-started
