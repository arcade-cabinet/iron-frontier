# Iron Frontier E2E Test: Settings Menu
# Tests all settings and preferences

appId: ${ANDROID_APP_ID}
name: Settings Test
tags:
  - settings
  - ui
  - preferences
  - p1

---
# Open settings from main menu or pause menu
- tapOn:
    text: "Settings"
    optional: true
- tapOn:
    text: "Options"
    optional: true
- tapOn:
    id: "settings-button"
    optional: true

# Wait for settings panel
- assertVisible:
    id: "settings-panel"
    timeout: ${DEFAULT_TIMEOUT}
    optional: true

- runFlow:
    when:
      visible:
        id: "settings-panel"
    commands:
      - takeScreenshot: screenshots/10-settings-main

      # Test Audio settings
      - tapOn:
          text: "Audio"
          optional: true
      - runFlow:
          when:
            visible:
              id: "audio-settings"
          commands:
            - takeScreenshot: screenshots/10-settings-audio
            # Adjust master volume
            - swipe:
                id: "master-volume-slider"
                direction: LEFT
                optional: true
            # Toggle music
            - tapOn:
                id: "music-toggle"
                optional: true
            # Toggle SFX
            - tapOn:
                id: "sfx-toggle"
                optional: true

      # Test Graphics settings
      - tapOn:
          text: "Graphics"
          optional: true
      - runFlow:
          when:
            visible:
              id: "graphics-settings"
          commands:
            - takeScreenshot: screenshots/10-settings-graphics
            # Cycle quality preset
            - tapOn:
                text: "Quality"
                optional: true
            - tapOn:
                text: "Medium"
                optional: true

      # Test Gameplay settings
      - tapOn:
          text: "Gameplay"
          optional: true
      - runFlow:
          when:
            visible:
              id: "gameplay-settings"
          commands:
            - takeScreenshot: screenshots/10-settings-gameplay
            # Toggle auto-save
            - tapOn:
                id: "autosave-toggle"
                optional: true
            # Adjust difficulty if present
            - tapOn:
                text: "Difficulty"
                optional: true
            - tapOn:
                text: "Normal"
                optional: true

      # Test Controls settings
      - tapOn:
          text: "Controls"
          optional: true
      - runFlow:
          when:
            visible:
              id: "controls-settings"
          commands:
            - takeScreenshot: screenshots/10-settings-controls
            # Toggle vibration
            - tapOn:
                id: "vibration-toggle"
                optional: true

      # Apply and close
      - tapOn:
          text: "Apply"
          optional: true
      - tapOn:
          text: "Save"
          optional: true
      - tapOn:
          text: "Close"
          optional: true
      - tapOn:
          text: "Back"
          optional: true

# Check no errors occurred
- assertNotVisible:
    text: "Error"
    optional: true

- takeScreenshot: screenshots/10-settings-complete
