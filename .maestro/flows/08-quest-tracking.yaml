# Iron Frontier E2E Test: Quest Tracking
# Tests quest log and tracking functionality

appId: ${ANDROID_APP_ID}
name: Quest Tracking Test
tags:
  - quests
  - ui
  - tracking
  - p1

---
# Open quest log
- tapOn:
    text: "Quests"
    optional: true
- tapOn:
    text: "Journal"
    optional: true
- tapOn:
    id: "quest-button"
    optional: true

# Wait for quest log to appear
- assertVisible:
    id: "quest-log"
    timeout: ${DEFAULT_TIMEOUT}
    optional: true

- runFlow:
    when:
      visible:
        id: "quest-log"
    commands:
      - takeScreenshot: screenshots/08-quest-log-open

      # Verify quest categories
      - assertVisible:
          text: "Main Quest"
          optional: true
      - assertVisible:
          text: "Side Quests"
          optional: true

      # Select a quest
      - tapOn:
          text: "Main Quest"
          optional: true
      - waitForAnimationToEnd:
          timeout: 2000

      # Check quest details
      - assertVisible:
          id: "quest-details"
          optional: true
      - takeScreenshot: screenshots/08-quest-details

      # Track quest
      - tapOn:
          text: "Track"
          optional: true
      - tapOn:
          id: "track-quest-button"
          optional: true

      # Verify tracking indicator
      - assertVisible:
          id: "quest-marker"
          optional: true

      # Close quest log
      - tapOn:
          text: "Close"
          optional: true
      - tapOn:
          text: "X"
          optional: true

# Verify quest tracker on HUD
- assertVisible:
    id: "quest-tracker"
    timeout: ${DEFAULT_TIMEOUT}
    optional: true

- runFlow:
    when:
      visible:
        id: "quest-tracker"
    commands:
      - takeScreenshot: screenshots/08-quest-tracker-hud
      # Verify objective is shown
      - assertVisible:
          id: "current-objective"
          optional: true

# Check no errors occurred
- assertNotVisible:
    text: "Error"
    optional: true

- takeScreenshot: screenshots/08-quest-tracking-complete
